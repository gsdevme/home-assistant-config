- id: "limit_charge_overnight"
  alias: "[Overnight] Limit charge"
  trigger:
    - platform: numeric_state
      entity_id: sensor.solis_inverter_battery
      value_template: "{{ state.state|float(0) - 1 }}"
      above: input_number.max_overnight_charge_percentage
      for:
        minutes: 5
  condition:
    - alias: "is cheap rate"
      condition: state
      entity_id: input_boolean.is_cheap_rate
      state: "on"
    - alias: "is not 100%"
      condition: numeric_state
      entity_id: input_number.max_overnight_charge_percentage
      below: 100
  action:
    - service: input_number.set_value
      entity_id: input_number.charge_amps
      data:
        value: 0.1
